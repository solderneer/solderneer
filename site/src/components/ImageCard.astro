---
import { Image } from 'astro:assets';

const { image, alt, caption } = Astro.props;

// Import all images eagerly
const images = import.meta.glob('../assets/**/*.{jpg,jpeg,png,webp}', { eager: true });

// Function to get the correct image dynamically
const getImage = (path) => images[`../assets/${path}`]?.default;

---

<figure class="image-card">
  <Image
    src={getImage(image)}
    alt={alt}
    class="image-card-img"
  />
  {caption && <figcaption>{caption}</figcaption>}
</figure>

<style>
  .image-card {
    margin: 1.5em auto;
    max-width: fit-content;
    counter-increment: figure;
  }

  .image-card-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0;
    border-radius: 4px;
  }

  figcaption {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.75rem;
    color: var(--text-tertiary);
    text-align: center;
    padding: 0.5em 0;
    letter-spacing: 0.02em;
  }

  figcaption::before {
    content: "Fig " counter(figure) ": ";
    font-weight: 500;
  }
</style>

